
<!DOCTYPE html>

<html>
  <head>
   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=G-QHB6CBHE8P"></script>
   <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QHB6CBHE8P');
   </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Merging &#8212; LeDataSciFi-2025</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/moviescript.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fin377_specialformatting.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/frontpage.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">LeDataSciFi-2025</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Syllabus
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../about/objectives.html">
   Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/outcomes.html">
   Outcomes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/about_us.html">
   About us + office hours
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/structure_and_policies.html">
   Course structure + policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/use_of_gpt.html">
   ChatGPT and other AI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/gradeoverview.html">
   Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/interest.html">
   Interested but unsure?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/bootcamp.html">
   Pre-Class Bootcamp
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/hall_of_awesomeness.html">
   The Hall of Awesomeness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/acknowledgments.html">
   Gratitude
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/03/05b_merging.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/LeDataSciFi/ledatascifi-2025"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/LeDataSciFi/ledatascifi-2025/issues/new?title=Issue%20on%20page%20%2Fcontent/03/05b_merging.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/LeDataSciFi/ledatascifi-2025/edit/main/content/03/05b_merging.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/LeDataSciFi/ledatascifi-2025/main?urlpath=lab/tree/content/03/05b_merging.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/LeDataSciFi/ledatascifi-2025/blob/main/content/03/05b_merging.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#important-parameters-of-pd-merge">
   Important parameters of
   <code class="docutils literal notranslate">
    <span class="pre">
     pd.merge()
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#categories-of-joins">
   Categories of joins
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indicator-true">
   <code class="docutils literal notranslate">
    <span class="pre">
     indicator=True
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-left-v-right-v-inner-v-outer">
   <code class="docutils literal notranslate">
    <span class="pre">
     how
    </span>
   </code>
   : left v. right v. inner v. outer
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#practice">
     Practice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-in-new-variables-to-your-analysis">
   Merging in new variables to your analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-your-variables-before-a-merge-when-possible">
   Create your variables before a merge when possible
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tips-and-best-practices">
   Tips and best practices
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-nice-overview">
   A nice overview
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="merging">
<h1>Merging<a class="headerlink" href="#merging" title="Permalink to this headline">¶</a></h1>
<p>You’ve already merged datasets. But so far, our examples have been “well-behaved” so it was easy to just proceed. But real world datasets are messy (bad variable names, poor documentation) and big, and so merging isn’t always as easy as “just do it”.</p>
<div class="section" id="important-parameters-of-pd-merge">
<h2>Important parameters of <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code><a class="headerlink" href="#important-parameters-of-pd-merge" title="Permalink to this headline">¶</a></h2>
<p>Read through the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html">parameters of the function here</a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">right</span> <span class="pre">=</span> <span class="pre">&lt;df&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">left</span> <span class="pre">=</span> <span class="pre">&lt;df&gt;</span></code> - name of your datasets</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">=</span> <span class="pre">&lt;var&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">on</span> <span class="pre">=</span> <span class="pre">[&lt;var1&gt;,&lt;var2&gt;,...]</span></code> - what variable(s) to use to match from the left and right datasets. These are your “keys”.</p>
<ul>
<li><p>if the variable names aren’t the same in both datasets (e.g. “ID” in one and “identity” in the other), use <code class="docutils literal notranslate"><span class="pre">left_on</span></code> and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> instead of <code class="docutils literal notranslate"><span class="pre">on</span></code> to specify the names in each</p></li>
<li><p>if the variables are the index variables, use <code class="docutils literal notranslate"><span class="pre">left_index</span> <span class="pre">=</span> <span class="pre">True</span></code> and/or <code class="docutils literal notranslate"><span class="pre">right_index</span> <span class="pre">=</span> <span class="pre">True</span></code> instead of <code class="docutils literal notranslate"><span class="pre">on</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span></code> - what observations are in the resulting dataset, <a class="reference external" href="#how-left-v-right-v-inner-v-outer">see below</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">suffix</span></code> - if a variable is in both datasets, how should we name each.</p>
<ul>
<li><p>**It’s a good idea to always use this option and specify the source, because the default option makes uninformative variable names! **</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">indicator=True</span></code> will create a variable saying which dataset the variable came from</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">validate</span></code> = “one_to_one”, “one_to_many”, or “many_to_one”. Will check if the merge is actually what you think it is. Useful!</p></li>
</ul>
<div class="warning admonition">
<p class="admonition-title">Be careful with the validate option</p>
<ul class="simple">
<li><p>Always use the “smallest” option you think is correct: If you’re doing a 1:1, type “one_to_one”</p></li>
<li><p>Don’t simply change it until the merge “works”! <strong>Errors are good!</strong></p>
<ul>
<li><p>either you’re merging “wrong” (picked the wrong “on” vars),</p></li>
<li><p>or the data has problems (duplicates where there shouldn’t be),</p></li>
<li><p>or you misunderstand the data</p></li>
<li><p>M:M can be dangerous</p></li>
</ul>
</li>
<li><p>The “many_to_many” will <em><strong>always</strong></em> work and is usually meaningless</p></li>
<li><p>NEVER USE THE MANY TO MANY OPTION (unless you’re super sure it’s correct for your application)</p></li>
</ul>
</div>
</div>
<div class="section" id="categories-of-joins">
<h2>Categories of joins<a class="headerlink" href="#categories-of-joins" title="Permalink to this headline">¶</a></h2>
<p>An important concept in merging is about how the keys you’re merging on are unique or not. You should be prepared that your merge might be:</p>
<ul class="simple">
<li><p><strong>1:1</strong>: The keys in each dataset are all unique</p></li>
<li><p><strong>1:M</strong>: The keys in right dataset have some duplicates</p></li>
<li><p><strong>M:1</strong>: The keys in left dataset have some duplicates</p></li>
<li><p><strong>M:M</strong>: The keys in both datasets have some duplicates</p></li>
</ul>
<p>What the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html#database-style-dataframe-or-named-series-joining-merging">pandas documentation</a> says is:</p>
<blockquote>
<div><p>In SQL / standard relational algebra, if a key combination appears more than once in [either or both] tables, the resulting table will have the Cartesian product of the associated data.</p>
</div></blockquote>
<p>That sounds complicated. What it means is: For a given row of data in the left dataset, we find all rows in the right dataset with the same key, and create that many rows in the merged dataset.</p>
<p>Let me just show you what that means. I’ll create two dataframes and merge them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">left_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                    <span class="s1">&#39;firm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Citi&#39;</span><span class="p">,</span><span class="s1">&#39;Citi&#39;</span><span class="p">,],</span>
                    <span class="s1">&#39;v1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;Bravo&#39;</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="n">left_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>firm</th>
      <th>v1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Citi</td>
      <td>Alpha</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Citi</td>
      <td>Bravo</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">right_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                    <span class="s1">&#39;firm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Citi&#39;</span><span class="p">,</span><span class="s1">&#39;Citi&#39;</span><span class="p">,</span><span class="s1">&#39;WF&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;v2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Charlie&#39;</span><span class="p">,</span><span class="s1">&#39;Delta&#39;</span><span class="p">,</span><span class="s1">&#39;Echo&#39;</span><span class="p">]})</span>    
<span class="n">display</span><span class="p">(</span><span class="n">right_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>firm</th>
      <th>v2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Citi</td>
      <td>Charlie</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Citi</td>
      <td>Delta</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WF</td>
      <td>Echo</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left_df</span><span class="p">,</span><span class="n">right_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>firm</th>
      <th>v1</th>
      <th>v2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Citi</td>
      <td>Alpha</td>
      <td>Charlie</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Citi</td>
      <td>Alpha</td>
      <td>Delta</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Citi</td>
      <td>Bravo</td>
      <td>Charlie</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Citi</td>
      <td>Bravo</td>
      <td>Delta</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>See? Each row on the left was matched with every row in the right data with the same key.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ol class="simple">
<li><p>Run this helper function before a merge. Does it think you’re doing the type of merge you think you are?</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">pd.merge(validate=...</span></code> argument to the type of merge you think you’re doing. It will produce an error before you start if you’re wrong, at which point you should look at your data more.</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">indicator=True</span></code> option inside <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code>. It gives you a variable you can use post-merge for diagnostics.</p></li>
</ol>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">merge_type</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span><span class="n">on</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function could use case test. E.g.: multiple key vars, missing vars </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Feature</span> <span class="n">request</span><span class="p">:</span> <span class="n">This</span> <span class="n">only</span> <span class="n">works</span> <span class="k">if</span> <span class="n">the</span> <span class="n">key</span> <span class="nb">vars</span> <span class="n">are</span> <span class="n">named</span> <span class="n">the</span> <span class="n">same</span> <span class="ow">in</span> <span class="n">both</span> <span class="n">datasets</span><span class="o">.</span>  
    <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    # if there are duplicates, dropping them will shrink the key vector</span>
<span class="s1">    if len(df1[on]) &gt; len(df1[on].drop_duplicates()):</span>
<span class="s1">        _l = &quot;many&quot;</span>
<span class="s1">    else:</span>
<span class="s1">        _l = &quot;one&quot;</span>
<span class="s1">    if len(df2[on]) &gt; len(df2[on].drop_duplicates()):</span>
<span class="s1">        _r = &quot;many&quot;</span>
<span class="s1">    else:</span>
<span class="s1">        _r = &quot;one&quot;</span>
<span class="s1">    return &quot;</span><span class="si">{}</span><span class="s1">_to_</span><span class="si">{}</span><span class="s1">&quot;.format(_l,_r)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merge_type</span><span class="p">(</span><span class="n">left_df</span><span class="p">,</span><span class="n">right_df</span><span class="p">,</span><span class="s1">&#39;firm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;many_to_many&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left_df</span><span class="p">,</span><span class="n">right_df</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;firm&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
                <span class="n">validate</span><span class="o">=</span><span class="s1">&#39;many_to_many&#39;</span><span class="p">,</span>
                <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>firm</th>
      <th>v1</th>
      <th>v2</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Citi</td>
      <td>Alpha</td>
      <td>Charlie</td>
      <td>both</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Citi</td>
      <td>Alpha</td>
      <td>Delta</td>
      <td>both</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Citi</td>
      <td>Bravo</td>
      <td>Charlie</td>
      <td>both</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Citi</td>
      <td>Bravo</td>
      <td>Delta</td>
      <td>both</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="indicator-true">
<h2><code class="docutils literal notranslate"><span class="pre">indicator=True</span></code><a class="headerlink" href="#indicator-true" title="Permalink to this headline">¶</a></h2>
<p>The post-merge variable created by <code class="docutils literal notranslate"><span class="pre">indicator=True</span></code> can be very useful to have around. After a merge, you can count the number of rows from each dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">some_informative_name</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span><span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">some_informative_name</span><span class="p">[</span><span class="s1">&#39;_merge&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> 
</pre></div>
</div>
<p>In action:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left_df</span><span class="p">,</span><span class="n">right_df</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;firm&#39;</span><span class="p">,</span>   <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span>  
         <span class="c1"># NOTICE! &quot;how&quot; has changed from prior example to outer</span>
                <span class="n">validate</span><span class="o">=</span><span class="s1">&#39;many_to_many&#39;</span><span class="p">,</span>
                <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)[</span><span class="s1">&#39;_merge&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>          <span class="c1"># [&#39;_merge&#39;].value_counts()  </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>both          4
right_only    1
left_only     0
Name: _merge, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-left-v-right-v-inner-v-outer">
<h2><code class="docutils literal notranslate"><span class="pre">how</span></code> : left v. right v. inner v. outer<a class="headerlink" href="#how-left-v-right-v-inner-v-outer" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>option</p></th>
<th class="text-align:left head"><p>observations in resulting dataset</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">&quot;inner&quot;</span></code></p></td>
<td class="text-align:left"><p>Keys (<code class="docutils literal notranslate"><span class="pre">on</span></code> variables) that are in both datasets</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">&quot;left&quot;</span></code></p></td>
<td class="text-align:left"><p>“inner” + all unmatched obs in left</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">&quot;right&quot;</span></code></p></td>
<td class="text-align:left"><p>“inner” + all unmatched obs in right</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">&quot;outer&quot;</span></code></p></td>
<td class="text-align:left"><p>“inner” + all unmatched obs in left and right</p></td>
</tr>
</tbody>
</table>
<p>Let’s illustrate that:</p>
<p><img alt="" src="../../_images/merges.png" /></p>
<div class="section" id="practice">
<h3>Practice<a class="headerlink" href="#practice" title="Permalink to this headline">¶</a></h3>
<p>Do a left, right, inner, and outer merge on these datasets to confirm the illustration on <code class="docutils literal notranslate"><span class="pre">how</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">left_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                    <span class="s1">&#39;firm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Accenture&#39;</span><span class="p">,</span><span class="s1">&#39;Citi&#39;</span><span class="p">,</span><span class="s1">&#39;GS&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;varA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">]})</span>

<span class="n">right_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                    <span class="s1">&#39;firm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;GS&#39;</span><span class="p">,</span><span class="s1">&#39;Chase&#39;</span><span class="p">,</span><span class="s1">&#39;WF&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;varB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;varc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">]})</span>                             
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="merging-in-new-variables-to-your-analysis">
<h2>Merging in new variables to your analysis<a class="headerlink" href="#merging-in-new-variables-to-your-analysis" title="Permalink to this headline">¶</a></h2>
<p>A typical “use case” for merging: You are working on some data you want to analyze (let’s call this the “left” data), and you want to merge in another dataset (the “right” data) in order to add a variable to your analysis.</p>
<div class="tip admonition">
<p class="admonition-title"><strong>HOT TIPS</strong></p>
<p><strong>The number of rows in your dataset shouldn’t change!</strong> Do both of these and you’ll be set:</p>
<ol class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">'left'</span></code></p>
<ul class="simple">
<li><p><em>From the table above, this means that the post-merge data will have a length equal to the number of unmatched rows from the left plus the number of rows from the intersection (“inner”)</em></p></li>
</ul>
</li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">validate='one_to_one'</span></code> or <code class="docutils literal notranslate"><span class="pre">validate='many_to_one'</span></code></p>
<ul class="simple">
<li><p>This means that any observations from the left that are matched to the right (the intersection of the two datasets) can only be matched to one observation. In other words, the intersection will not be larger than it is in the left data.</p></li>
</ul>
</li>
</ol>
</div>
<p>You can verify your dataset is the same length before and after the merge many ways. Here is an easy one:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># a way to check; this is pseudo code </span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">someNewData</span><span class="p">,</span> 
              <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="n">listofvars</span><span class="p">],</span>
              <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
              <span class="n">validate</span><span class="o">=</span><span class="s1">&#39;one_to_one&#39;</span><span class="p">)</span> <span class="c1"># or &#39;many_to_one&#39;</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-your-variables-before-a-merge-when-possible">
<h2>Create your variables before a merge when possible<a class="headerlink" href="#create-your-variables-before-a-merge-when-possible" title="Permalink to this headline">¶</a></h2>
<p>Suppose you want to merge in a new variable to your analysis data. The variable is a function of a variable in another dataset. Should we create the variable before the merge or after the merge?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># before </span>
<span class="n">newVar</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="n">left</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">newVar</span><span class="p">)</span>

<span class="c1"># after </span>
<span class="n">merge</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<span class="n">merge</span><span class="p">[</span><span class="s1">&#39;newVar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">merge</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Both are feasible! So which should you choose?</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../02/10_Golden_3.html"><span class="doc std std-doc">Golden Rule 4.B from the Good Analysis Practices chapter</span></a> is “Keep data normalized as far into your code pipeline as you can.”</p>
</div>
<p>One implication of that is to create variables on the “smallest” dataset where you can validly compute the variable. By “smallest”, I mean: the dataset where the units exactly correspond to the statistic you have in mind.</p>
<p>Example: Suppose you want to calculate the variance of annual industry sales.</p>
<ul class="simple">
<li><p>Do this: Open an industry-level dataset with annual sales, and take the variance.</p></li>
<li><p>Not this: Merge annual sales into a industry-day level dataset (with many days for each industry) and then take the variance.</p></li>
</ul>
<p>Let me show you that the latter can give you the wrong answer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                   <span class="s2">&quot;industry&quot;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> 
                   <span class="p">})</span> 
<span class="n">right</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STD if you calculate it before the merge:&quot;</span><span class="p">,</span><span class="n">right</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>industry</th>
      <th>x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>STD if you calculate it before the merge: 3.271085446759225
</pre></div>
</div>
</div>
</div>
<p>So that is the correct standard deviation.</p>
<p>If you use this as the right dataframe in a M:1 merge with an industry-day dataset as the left, then what happens is that our right df will be duplicated in the post-merge dataset many times: Each 1 of the right dataframe is matched to the left M times. And this leads to an error in the calculation!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># these lines of code stack the right df 6 times, as would happen </span>
<span class="c1"># if the left df had 6 days for each industry </span>
<span class="n">after_merge</span> <span class="o">=</span> <span class="n">right</span>
<span class="n">after_merge</span> <span class="o">=</span> <span class="n">after_merge</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STD if you calculate it after the merge:&quot;</span><span class="p">,</span><span class="n">after_merge</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>STD if you calculate it after the merge: 3.028436654683167
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tips-and-best-practices">
<h2>Tips and best practices<a class="headerlink" href="#tips-and-best-practices" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>⭐⭐⭐ <strong>THESE ARE IMPORTANT</strong> ⭐⭐⭐</p>
</div>
</div>
<ol>
<li><p><strong>Pick the “keys” you’ll merge on</strong></p>
<ol class="simple">
<li><p>What are the observation units in each of your datasets?</p></li>
<li><p>What variable (<strong>or variables</strong>) should you be merging on? For example: Should you merge based on the firm, or the firm AND the year?<br />
<br>
<strong>I usually merge with as many levels of units as are in both datasets.</strong> So if I have two firm-year datasets, I merge on firm AND year. If I have an asset-day dataset (stock returns) and a daily dataset (returns for the overall stock market), merge on the date.</p></li>
</ol>
</li>
<li><p><strong>Before (before!) your merge, examine the keys</strong></p>
<ol class="simple">
<li><p>Drop any observations with missing keys in each dataset</p></li>
<li><p>How many unique keys are in each dataset? Simply replace <code class="docutils literal notranslate"><span class="pre">df</span></code> and <code class="docutils literal notranslate"><span class="pre">keyvars</span></code> in this: <code class="docutils literal notranslate"><span class="pre">len(df[&lt;keyvars&gt;].drop_duplicates()</span></code></p></li>
<li><p>Know what the observation unit will be after your merge. E.g., if you have a firm dataset, and a weekly dataset, the resulting dataset might be a firm-week data.</p></li>
</ol>
</li>
<li><p><strong>Always specify <code class="docutils literal notranslate"><span class="pre">how</span></code>, <code class="docutils literal notranslate"><span class="pre">on</span></code>, <code class="docutils literal notranslate"><span class="pre">indicator</span></code>, and <code class="docutils literal notranslate"><span class="pre">validate</span></code> inside <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> or <code class="docutils literal notranslate"><span class="pre">df1.merge(df2)</span></code></strong></p>
<ol class="simple">
<li><p>This will force you to think about the observation levels in each dataset you’re merging before you try the merge, and whether the merge you’re doing is 1:1, 1:M, M:M, or M:1.</p></li>
<li><p>Guess how many observations you’ll have (more or less than left? more or less than right or left?) and then check afterwards.</p></li>
</ol>
</li>
<li><p><strong>After the merge</strong>, check that it did what you expected, and give the resulting dataframe a <em>good</em> name. <strong>Don’t name it “merged”!!!</strong></p>
<ol>
<li><p>Look at a good chunk of data before and after the merge. This is just following the “look at the data” golden rule.</p></li>
<li><p>Examine the <code class="docutils literal notranslate"><span class="pre">_merge</span></code> variable (value_counts, e.g.)</p></li>
<li><p>Good names: I often actively name the dataframe to the new observation level.</p>
<p><em>For example, I know exactly how <code class="docutils literal notranslate"><span class="pre">state_industry_year_df</span></code> and <code class="docutils literal notranslate"><span class="pre">state_industry_df</span></code> should differ.</em></p>
</li>
</ol>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If I see assignments with a line like <code class="docutils literal notranslate"><span class="pre">merged=pd.merge(...)</span></code> I’ll mark that down automatically. (You name it <code class="docutils literal notranslate"><span class="pre">merged</span></code>!)</p>
<p>If I see assignments with a line like <code class="docutils literal notranslate"><span class="pre">merged=pd.merge(df1,df2)</span></code> or <code class="docutils literal notranslate"><span class="pre">merged</span> <span class="pre">=</span> <span class="pre">df1.merge(df2)</span></code>, I’ll mark that down automatically. (You didn’t declare the merge function parameters!)</p>
</div>
</div>
<div class="section" id="a-nice-overview">
<h2>A nice overview<a class="headerlink" href="#a-nice-overview" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.07-merge-and-join.html">Python Data Science Handbook</a> has a wonderful breakdown of the mechanics of merging. You should read it!</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Prof. Donald Bowen<br/>
        
            &copy; Copyright 2025.<br/>
          <div class="extra_footer">
            You're doing well, keep going!
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>